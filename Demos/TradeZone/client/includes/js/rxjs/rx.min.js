(function(n,t){function w(){}function et(n){return n}function ot(){return(new Date).getTime()}function ir(n,t){return n===t}function ri(n,t){return n-t}function ui(n){return n.toString()}function rr(n){throw n;}function b(){if(this.isDisposed)throw new Error(fr);}function ut(n,t){return n.length===1&&Array.isArray(n[t])?n[t]:s.call(n)}function st(n,t){for(var r=new Array(n),i=0;i<n;i++)r[i]=t();return r}function fi(n,t){this.scheduler=n,this.disposable=t,this.isDisposed=!1}function tt(n,t,i,r,u){this.scheduler=n,this.state=t,this.action=i,this.dueTime=r,this.comparer=u||ri,this.disposable=new e}function wr(n,t){return new r(function(i){var u=new e,r=new c;return r.setDisposable(u),u.setDisposable(n.subscribe(i.onNext.bind(i),function(n){var u,f;try{f=t(n)}catch(o){i.onError(o);return}u=new e,r.setDisposable(u),u.setDisposable(f.subscribe(i))},i.onCompleted.bind(i))),r})}function br(n,t){var i=this;return new r(function(r){var u=0,f=n.length;return i.subscribe(function(i){if(u<f){var o=n[u++],e;try{e=t(i,o)}catch(s){r.onError(s);return}r.onNext(e)}else r.onCompleted()},r.onError.bind(r),r.onCompleted.bind(r))})}function gi(n){return this.select(n).mergeObservable()}var lt=typeof exports=="object"&&exports&&(typeof global=="object"&&global&&global==global.global&&(n=global),exports),u={Internals:{}},ur="Sequence contains no elements.",k="Argument out of range",fr="Object has been disposed",s=Array.prototype.slice,nu={}.hasOwnProperty,h=this.inherits=u.Internals.inherits=function(n,t){function i(){this.constructor=n}i.prototype=t.prototype,n.prototype=new i},at=u.Internals.addProperties=function(n){for(var u=s.call(arguments,1),i,r,t=0,f=u.length;t<f;t++){i=u[t];for(r in i)n[r]=i[r]}},er=u.Internals.addRef=function(n,t){return new r(function(i){return new o(t.getDisposable(),n.subscribe(i))})},vt,yt,pt,nt,p,o,d,ft,c,wt,ai,vi,ni,yi,ti,pi,wi,bi,ki,di;Function.prototype.bind||(Function.prototype.bind=function(n){var t=this,i=s.call(arguments,1),r=function(){if(this instanceof r){function n(){}n.prototype=t.prototype;var f=new n,u=t.apply(f,i.concat(s.call(arguments)));return Object(u)===u?u:f}return t.apply(n,i.concat(s.call(arguments)))};return r}),vt=Object("a"),yt=vt[0]!="a"||!(0 in vt),Array.prototype.every||(Array.prototype.every=function(n){var r=Object(this),i=yt&&{}.toString.call(this)=="[object String]"?this.split(""):r,u=i.length>>>0,f=arguments[1],t;if({}.toString.call(n)!="[object Function]")throw new TypeError(n+" is not a function");for(t=0;t<u;t++)if(t in i&&!n.call(f,i[t],t,r))return!1;return!0}),Array.prototype.map||(Array.prototype.map=function(n){var r=Object(this),i=yt&&{}.toString.call(this)=="[object String]"?this.split(""):r,u=i.length>>>0,f=Array(u),e=arguments[1],t;if({}.toString.call(n)!="[object Function]")throw new TypeError(n+" is not a function");for(t=0;t<u;t++)t in i&&(f[t]=n.call(e,i[t],t,r));return f}),Array.prototype.filter||(Array.prototype.filter=function(n){for(var u=[],r,i=new Object(this),t=0,f=i.length>>>0;t<f;t++)r=i[t],t in i&&n.call(arguments[1],r,t,i)&&u.push(r);return u}),Array.isArray||(Array.isArray=function(n){return Object.prototype.toString.call(n)=="[object Array]"}),Array.prototype.indexOf||(Array.prototype.indexOf=function(n){var u=Object(this),r=u.length>>>0,t,i;if(r===0||(t=0,arguments.length>1&&(t=Number(arguments[1]),t!=t?t=0:t!=0&&t!=Infinity&&t!=-Infinity&&(t=(t>0||-1)*Math.floor(Math.abs(t)))),t>=r))return-1;for(i=t>=0?t:Math.max(r-Math.abs(t),0);i<r;i++)if(i in u&&u[i]===n)return i;return-1}),pt=function(n,t){this.id=n,this.value=t},pt.prototype.compareTo=function(n){var t=this.value.compareTo(n.value);return t===0&&(t=this.id-n.id),t},nt=function(n){this.items=new Array(n),this.length=0},p=nt.prototype,p.isHigherPriority=function(n,t){return this.items[n].compareTo(this.items[t])<0},p.percolate=function(n){var t,i;n>=this.length||n<0||(t=n-1>>1,t<0||t===n)||this.isHigherPriority(n,t)&&(i=this.items[n],this.items[n]=this.items[t],this.items[t]=i,this.percolate(t))},p.heapify=function(n){var f;if(n===t&&(n=0),!(n>=this.length)&&!(n<0)){var r=2*n+1,u=2*n+2,i=n;r<this.length&&this.isHigherPriority(r,i)&&(i=r),u<this.length&&this.isHigherPriority(u,i)&&(i=u),i!==n&&(f=this.items[n],this.items[n]=this.items[i],this.items[i]=f,this.heapify(i))}},p.peek=function(){return this.items[0].value},p.removeAt=function(n){this.items[n]=this.items[--this.length],delete this.items[this.length],this.heapify()},p.dequeue=function(){var n=this.peek();return this.removeAt(0),n},p.enqueue=function(n){var t=this.length++;this.items[t]=new pt(nt.count++,n),this.percolate(t)},p.remove=function(n){for(var t=0;t<this.length;t++)if(this.items[t].value===n)return this.removeAt(t),!0;return!1},nt.count=0,o=u.CompositeDisposable=function(){this.disposables=ut(arguments,0),this.isDisposed=!1,this.length=this.disposables.length},d=o.prototype,d.add=function(n){this.isDisposed?n.dispose():(this.disposables.push(n),this.length++)},d.remove=function(n){var i=!1,t;return this.isDisposed||(t=this.disposables.indexOf(n),t!==-1&&(i=!0,this.disposables.splice(t,1),this.length--,n.dispose())),i},d.dispose=function(){var t,n,i;if(!this.isDisposed)for(this.isDisposed=!0,t=this.disposables.slice(0),this.disposables=[],this.length=0,n=0,i=t.length;n<i;n++)t[n].dispose()},d.clear=function(){var t=this.disposables.slice(0),n,i;for(this.disposables=[],this.length=0,n=0,i=t.length;n<i;n++)t[n].dispose()},d.contains=function(n){return this.disposables.indexOf(n)!==-1},d.toArray=function(){return this.disposables.slice(0)},ft=u.Disposable=function(n){this.isDisposed=!1,this.action=n},ft.prototype.dispose=function(){this.isDisposed||(this.action(),this.isDisposed=!0)};var g=ft.create=function(n){return new ft(n)},l=ft.empty={dispose:w},e=u.SingleAssignmentDisposable=function(){this.isDisposed=!1,this.current=null},ht=e.prototype;ht.disposable=function(n){return n?this.setDisposable(n):this.getDisposable()},ht.getDisposable=function(){return this.current},ht.setDisposable=function(n){if(this.current)throw new Error("Disposable has already been assigned");var t=this.isDisposed;t||(this.current=n),t&&n&&n.dispose()},ht.dispose=function(){var n;this.isDisposed||(this.isDisposed=!0,n=this.current,this.current=null),n&&n.dispose()},c=u.SerialDisposable=function(){this.isDisposed=!1,this.current=null},c.prototype.getDisposable=function(){return this.current},c.prototype.setDisposable=function(n){var i=this.isDisposed,t;i||(t=this.current,this.current=n),t&&t.dispose(),i&&n&&n.dispose()},c.prototype.disposable=function(n){if(n)this.setDisposable(n);else return this.getDisposable()},c.prototype.dispose=function(){var n;this.isDisposed||(this.isDisposed=!0,n=this.current,this.current=null),n&&n.dispose()},wt=u.RefCountDisposable=function(){function t(n){this.disposable=n,this.disposable.count++,this.isInnerDisposed=!1}function n(n){this.underlyingDisposable=n,this.isDisposed=!1,this.isPrimaryDisposed=!1,this.count=0}return t.prototype.dispose=function(){this.disposable.isDisposed||this.isInnerDisposed||(this.isInnerDisposed=!0,this.disposable.count--,this.disposable.count===0&&this.disposable.isPrimaryDisposed&&(this.disposable.isDisposed=!0,this.disposable.underlyingDisposable.dispose()))},n.prototype.dispose=function(){this.isDisposed||this.isPrimaryDisposed||(this.isPrimaryDisposed=!0,this.count===0&&(this.isDisposed=!0,this.underlyingDisposable.dispose()))},n.prototype.getDisposable=function(){return this.isDisposed?l:new t(this)},n}(),fi.prototype.dispose=function(){var n=this;this.scheduler.schedule(function(){n.isDisposed||(n.isDisposed=!0,n.disposable.dispose())})},tt.prototype.invoke=function(){this.disposable.disposable(this.invokeCore())},tt.prototype.compareTo=function(n){return this.comparer(this.dueTime,n.dueTime)},tt.prototype.isCancelled=function(){return this.disposable.isDisposed},tt.prototype.invokeCore=function(){return this.action(this.scheduler,this.state)};var a=u.Scheduler=function(){function i(n,t,i,r){this.now=n,this._schedule=t,this._scheduleRelative=i,this._scheduleAbsolute=r}function f(n,t){var u=t.first,f=t.second,i=new o,r=function(t){f(t,function(t){var u=!1,f=!1,e=n.scheduleWithState(t,function(n,t){return u?i.remove(e):f=!0,r(t),l});f||(i.add(e),u=!0)})};return r(u),i}function u(n,t,i){var f=t.first,e=t.second,r=new o,u=function(t){e(t,function(t,f){var e=!1,o=!1,s=n[i].call(n,t,f,function(n,t){return e?r.remove(s):o=!0,u(t),l});o||(r.add(s),e=!0)})};return u(f),r}function r(n,t){return t(),l}var t=i.prototype;return t.catchException=function(n){return new cr(this,n)},t.schedulePeriodic=function(n,t){return this.schedulePeriodicWithState(null,n,function(){t()})},t.schedulePeriodicWithState=function(t,i,r){var u=t,f=n.setInterval(function(){u=r(u)},i);return g(function(){n.clearInterval(f)})},t.schedule=function(n){return this._schedule(n,r)},t.scheduleWithState=function(n,t){return this._schedule(n,t)},t.scheduleWithRelative=function(n,t){return this._scheduleRelative(t,n,r)},t.scheduleWithRelativeAndState=function(n,t,i){return this._scheduleRelative(n,t,i)},t.scheduleWithAbsolute=function(n,t){return this._scheduleAbsolute(t,n,r)},t.scheduleWithAbsoluteAndState=function(n,t,i){return this._scheduleAbsolute(n,t,i)},t.scheduleRecursive=function(n){return this.scheduleRecursiveWithState(n,function(n,t){n(function(){t(n)})})},t.scheduleRecursiveWithState=function(n,t){return this.scheduleWithState({first:n,second:t},function(n,t){return f(n,t)})},t.scheduleRecursiveWithRelative=function(n,t){return this.scheduleRecursiveWithRelativeAndState(t,n,function(n,t){n(function(i){t(n,i)})})},t.scheduleRecursiveWithRelativeAndState=function(n,t,i){return this._scheduleRelative({first:n,second:i},t,function(n,t){return u(n,t,"scheduleWithRelativeAndState")})},t.scheduleRecursiveWithAbsolute=function(n,t){return this.scheduleRecursiveWithAbsoluteAndState(t,n,function(n,t){n(function(i){t(n,i)})})},t.scheduleRecursiveWithAbsoluteAndState=function(n,t,i){return this._scheduleAbsolute({first:n,second:i},t,function(n,t){return u(n,t,"scheduleWithAbsoluteAndState")})},i.now=ot,i.normalize=function(n){return n<0&&(n=0),n},i}(),or="Scheduler is not allowed to block the thread",v=a.immediate=function(){function n(n,t){return t(this,n)}function t(n,t,i){if(t>0)throw new Error(or);return i(this,n)}function i(n,t,i){return this.scheduleWithRelativeAndState(n,t-this.now(),i)}return new a(ot,n,t,i)}(),it=a.currentThread=function(){function i(){n=new nt(4)}function r(n,t){return this.scheduleWithRelativeAndState(n,0,t)}function u(t,r,u){var o=this.now()+a.normalize(r),f=new tt(this,t,u,o),e;if(n)n.enqueue(f);else{e=new i;try{n.enqueue(f),e.run()}catch(s){throw s;}finally{e.dispose()}}return f.disposable}function f(n,t,i){return this.scheduleWithRelativeAndState(n,t-this.now(),i)}var n,t;return i.prototype.dispose=function(){n=null},i.prototype.run=function(){for(var t;n.length>0;)if(t=n.dequeue(),!t.isCancelled()){while(t.dueTime-a.now()>0);t.isCancelled()||t.invoke()}},t=new a(ot,r,u,f),t.scheduleRequired=function(){return n===null},t.ensureTrampoline=function(t){return n===null?this.schedule(t):t()},t}(),sr=function(){function t(n,t){t(0,this._period);try{this._state=this._action(this._state)}catch(i){this._cancel.dispose();throw i;}}function n(n,t,i,r){this._scheduler=n,this._state=t,this._period=i,this._action=r}return n.prototype.start=function(){var n=new e;return this._cancel=n,n.setDisposable(this._scheduler.scheduleRecursiveWithRelativeAndState(0,this._period,t.bind(this))),n},n}();u.VirtualTimeScheduler=function(n){function u(){return this.toDateTimeOffset(this.clock)}function f(n,t){return this.scheduleAbsoluteWithState(n,this.clock,t)}function e(n,t,i){return this.scheduleRelativeWithState(n,this.toRelative(t),i)}function o(n,t,i){return this.scheduleRelativeWithState(n,this.toRelative(t-this.now()),i)}function r(n,t){return t(),l}function i(t,i){this.clock=t,this.comparer=i,this.isEnabled=!1,this.queue=new nt(1024),n.call(this,u,f,e,o)}h(i,n);var t=i.prototype;return t.schedulePeriodicWithState=function(n,t,i){var r=new sr(this,n,t,i);return r.start()},t.scheduleRelativeWithState=function(n,t,i){var r=this.add(this.clock,t);return this.scheduleAbsoluteWithState(n,r,i)},t.scheduleRelative=function(n,t){return this.scheduleRelativeWithState(t,n,r)},t.start=function(){var n;if(!this.isEnabled){this.isEnabled=!0;do n=this.getNext(),n!==null?(this.comparer(n.dueTime,this.clock)>0&&(this.clock=n.dueTime),n.invoke()):this.isEnabled=!1;while(this.isEnabled)}},t.stop=function(){this.isEnabled=!1},t.advanceTo=function(n){var t,i=this.comparer(this.clock,n);if(this.comparer(this.clock,n)>0)throw new Error(k);if(i!==0&&!this.isEnabled){this.isEnabled=!0;do t=this.getNext(),t!==null&&this.comparer(t.dueTime,n)<=0?(this.comparer(t.dueTime,this.clock)>0&&(this.clock=t.dueTime),t.invoke()):this.isEnabled=!1;while(this.isEnabled);this.clock=n}},t.advanceBy=function(n){var t=this.add(this.clock,n),i=this.comparer(this.clock,t);if(i>0)throw new Error(k);if(i!==0)return this.advanceTo(t)},t.sleep=function(n){var t=this.add(this.clock,n);if(this.comparer(this.clock,t)>=0)throw new Error(k);this.clock=t},t.getNext=function(){for(var n;this.queue.length>0;)if(n=this.queue.peek(),n.isCancelled())this.queue.dequeue();else return n;return null},t.scheduleAbsolute=function(n,t){return this.scheduleAbsoluteWithState(t,n,r)},t.scheduleAbsoluteWithState=function(n,t,i){var r=this,f=function(n,t){return r.queue.remove(u),i(n,t)},u=new tt(r,n,f,t,r.comparer);return r.queue.enqueue(u),u.disposable},i}(a),u.HistoricalScheduler=function(n){function t(t,i){var r=t==null?0:t,u=i||ri;n.call(this,r,u)}h(t,n);var i=t.prototype;return i.add=function(n,t){return n+t},i.toDateTimeOffset=function(n){return new Date(n).getTime()},i.toRelative=function(n){return n},t}(u.VirtualTimeScheduler);var hr=a.timeout=function(){function h(n,t){var f=this,i=new e,s=r(function(){i.setDisposable(t(f,n))});return new o(i,g(function(){u(s)}))}function c(t,i,r){var f=this,s=a.normalize(i),u,h;return s===0?f.scheduleWithState(t,r):(u=new e,h=n.setTimeout(function(){u.setDisposable(r(f,t))},s),new o(u,g(function(){n.clearTimeout(h)})))}function l(n,t,i){return this.scheduleWithRelativeAndState(n,t-this.now(),i)}var t="equestAnimationFrame",i="ancelAnimationFrame",f=n["r"+t]||n["webkitR"+t]||n["mozR"+t]||n["oR"+t]||n["msR"+t],s=n["c"+i]||n["webkitC"+i]||n["mozC"+i]||n["oC"+i]||n["msC"+i],r,u;return typeof n.process!="undefined"&&typeof n.process.nextTick=="function"?(r=n.process.nextTick,u=w):typeof n.setImmediate=="function"?(r=n.setImmediate,u=n.clearImmediate):typeof f=="function"?(r=f,u=s):(r=function(t){return n.setTimeout(t,0)},u=n.clearTimeout),new a(ot,h,c,l)}(),cr=function(n){function i(){return this._scheduler.now()}function r(n,t){return this._scheduler.scheduleWithState(n,this._wrap(t))}function u(n,t,i){return this._scheduler.scheduleWithRelativeAndState(n,t,this._wrap(i))}function f(n,t,i){return this._scheduler.scheduleWithAbsoluteAndState(n,t,this._wrap(i))}function t(t,e){this._scheduler=t,this._handler=e,this._recursiveOriginal=null,this._recursiveWrapper=null,n.call(this,i,r,u,f)}return h(t,n),t.prototype._clone=function(n){return new t(n,this._handler)},t.prototype._wrap=function(n){var t=this;return function(i,r){try{return n(t._getRecursiveWrapper(i),r)}catch(u){if(!t._handler(u))throw u;return l}}},t.prototype._getRecursiveWrapper=function(n){if(!this._recursiveOriginal!==n){this._recursiveOriginal=n;var t=this._clone(n);t._recursiveOriginal=n,t._recursiveWrapper=t,this._recursiveWrapper=t}return this._recursiveWrapper},t.prototype.schedulePeriodicWithState=function(n,t,i){var f=this,u=!1,r=new e;return r.setDisposable(this._scheduler.schedulePeriodicWithState(n,t,function(n){if(u)return null;try{return i(n)}catch(t){if(u=!0,!f._handler(t))throw t;return r.dispose(),null}})),r},t}(a),rt=u.Notification=function(){function t(n,t){this.hasValue=t==null?!1:t,this.kind=n}var n=t.prototype;return n.accept=function(n,t,i){return arguments.length===1&&typeof n=="object"?this._acceptObservable(n):this._accept(n,t,i)},n.toObservable=function(n){var t=this;return n=n||v,new r(function(i){return n.schedule(function(){t._acceptObservable(i),t.kind==="N"&&i.onCompleted()})})},n.equals=function(n){var t=n==null?"":n.toString();return this.toString()===t},t}(),ei=rt.createOnNext=function(){function n(n){return n(this.value)}function t(n){return n.onNext(this.value)}function i(){return"OnNext("+this.value+")"}return function(r){var u=new rt("N",!0);return u.value=r,u._accept=n.bind(u),u._acceptObservable=t.bind(u),u.toString=i.bind(u),u}}(),oi=rt.createOnError=function(){function n(n,t){return t(this.exception)}function t(n){return n.onError(this.exception)}function i(){return"OnError("+this.exception+")"}return function(r){var u=new rt("E");return u.exception=r,u._accept=n.bind(u),u._acceptObservable=t.bind(u),u.toString=i.bind(u),u}}(),si=rt.createOnCompleted=function(){function n(n,t,i){return i()}function t(n){return n.onCompleted()}function i(){return"OnCompleted()"}return function(){var r=new rt("C");return r._accept=n.bind(r),r._acceptObservable=t.bind(r),r.toString=i.bind(r),r}}(),hi=u.Internals.Enumerator=function(n,t,i){this.moveNext=n,this.getCurrent=t,this.dispose=i},ci=hi.create=function(n,t,i){var r=!1;return i||(i=w),new hi(function(){if(r)return!1;var t=n();return t||(r=!0,i()),t},function(){return t()},function(){r||(i(),r=!0)})},ct=u.Internals.Enumerable=function(){function n(n){this.getEnumerator=n}return n.prototype.concat=function(){var n=this;return new r(function(t){var i=n.getEnumerator(),r=!1,u=new c,f=v.scheduleRecursive(function(n){var h,f,o=!1,s;if(!r){try{o=i.moveNext(),o?h=i.getCurrent():i.dispose()}catch(c){f=c,i.dispose()}if(f){t.onError(f);return}if(!o){t.onCompleted();return}s=new e,u.setDisposable(s),s.setDisposable(h.subscribe(t.onNext.bind(t),t.onError.bind(t),function(){n()}))}});return new o(u,f,g(function(){r=!0,i.dispose()}))})},n.prototype.catchException=function(){var n=this;return new r(function(t){var r=n.getEnumerator(),u=!1,i,f=new c,s=v.scheduleRecursive(function(n){var c,s,o,h;if(o=!1,!u){try{o=r.moveNext(),o&&(c=r.getCurrent())}catch(l){s=l}if(s){t.onError(s);return}if(!o){if(i)t.onError(i);else t.onCompleted();return}h=new e,f.setDisposable(h),h.setDisposable(c.subscribe(t.onNext.bind(t),function(t){i=t,n()},t.onCompleted.bind(t)))}});return new o(f,s,g(function(){u=!0}))})},n}(),li=ct.repeat=function(n,i){return i===t&&(i=-1),new ct(function(){var r,t=i;return ci(function(){return t===0?!1:(t>0&&t--,r=n,!0)},function(){return r})})},bt=ct.forEach=function(n,t){return t||(t=et),new ct(function(){var r,i=-1;return ci(function(){return++i<n.length?(r=t(n[i],i),!0):!1},function(){return r})})},y=u.Observer=function(){};y.prototype.toNotifier=function(){var n=this;return function(t){return t.accept(n)}},y.prototype.asObserver=function(){return new dt(this.onNext.bind(this),this.onError.bind(this),this.onCompleted.bind(this))},y.prototype.checked=function(){return new lr(this)},ai=y.create=function(n,t,i){return n||(n=w),t||(t=rr),i||(i=w),new dt(n,t,i)},y.fromNotifier=function(n){return new dt(function(t){return n(ei(t))},function(t){return n(oi(t))},function(){return n(si())})};var kt=u.Internals.AbstractObserver=function(n){function t(){this.isStopped=!1,n.call(this)}return h(t,n),t.prototype.onNext=function(n){this.isStopped||this.next(n)},t.prototype.onError=function(n){this.isStopped||(this.isStopped=!0,this.error(n))},t.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.completed())},t.prototype.dispose=function(){this.isStopped=!0},t.prototype.fail=function(){return this.isStopped?!1:(this.isStopped=!0,this.error(!0),!0)},t}(y),dt=u.AnonymousObserver=function(n){function t(t,i,r){n.call(this),this._onNext=t,this._onError=i,this._onCompleted=r}return h(t,n),t.prototype.next=function(n){this._onNext(n)},t.prototype.error=function(n){this._onError(n)},t.prototype.completed=function(){this._onCompleted()},t}(kt),lr=function(n){function i(t){n.call(this),this._observer=t,this._state=0}h(i,n);var t=i.prototype;return t.onNext=function(n){this.checkAccess();try{this._observer.onNext(n)}catch(t){throw t;}finally{this._state=0}},t.onError=function(n){this.checkAccess();try{this._observer.onError(n)}catch(t){throw t;}finally{this._state=2}},t.onCompleted=function(){this.checkAccess();try{this._observer.onCompleted()}catch(n){throw n;}finally{this._state=2}},t.checkAccess=function(){if(this._state===1)throw new Error("Re-entrancy detected");if(this._state===2)throw new Error("Observer completed");this._state===0&&(this._state=1)},i}(y),ar=u.Internals.ScheduledObserver=function(n){function t(t,i){n.call(this),this.scheduler=t,this.observer=i,this.isAcquired=!1,this.hasFaulted=!1,this.queue=[],this.disposable=new c}return h(t,n),t.prototype.next=function(n){var t=this;this.queue.push(function(){t.observer.onNext(n)})},t.prototype.error=function(n){var t=this;this.queue.push(function(){t.observer.onError(n)})},t.prototype.completed=function(){var n=this;this.queue.push(function(){n.observer.onCompleted()})},t.prototype.ensureActive=function(){var t=!1,n=this;!this.hasFaulted&&this.queue.length>0&&(t=!this.isAcquired,this.isAcquired=!0),t&&this.disposable.setDisposable(this.scheduler.scheduleRecursive(function(t){var i;if(n.queue.length>0)i=n.queue.shift();else{n.isAcquired=!1;return}try{i()}catch(r){n.queue=[],n.hasFaulted=!0;throw r;}t()}))},t.prototype.dispose=function(){n.prototype.dispose.call(this),this.disposable.dispose()},t}(kt),vr=function(n){function t(){n.apply(this,arguments)}return h(t,n),t.prototype.next=function(t){n.prototype.next.call(this,t),this.ensureActive()},t.prototype.error=function(t){n.prototype.error.call(this,t),this.ensureActive()},t.prototype.completed=function(){n.prototype.completed.call(this),this.ensureActive()},t}(ar),i,f=u.Observable=function(){function n(n){this._subscribe=n}return i=n.prototype,i.finalValue=function(){var n=this;return new r(function(t){var i=!1,r;return n.subscribe(function(n){i=!0,r=n},t.onError.bind(t),function(){if(i){t.onNext(r);t.onCompleted()}else t.onError(new Error(ur))})})},i.subscribe=i.forEach=function(n,t,i){var r;return r=typeof n=="object"?n:ai(n,t,i),this._subscribe(r)},i.toArray=function(){function n(n,t){var i=n.slice(0);return i.push(t),i}return this.scan([],n).startWith([]).finalValue()},n}();f.start=function(n,t){return vi(n,t)()},vi=f.toAsync=function(n,t,i){return t||(t=hr),function(){var u=s.call(arguments,0),r=new dr;return t.schedule(function(){var t;try{t=n.apply(i,u)}catch(f){r.onError(f);return}r.onNext(t);r.onCompleted()}),r.asObservable()}},i.observeOn=function(n){var t=this;return new r(function(i){return t.subscribe(new vr(n,i))})},i.subscribeOn=function(n){var t=this;return new r(function(i){var u=new e,r=new c;return r.setDisposable(u),u.setDisposable(n.schedule(function(){r.setDisposable(new fi(n,t.subscribe(i)))})),r})},f.create=function(n){return new r(function(t){return g(n(t))})},f.createWithDisposable=function(n){return new r(n)};var yr=f.defer=function(n){return new r(function(t){var i;try{i=n()}catch(r){return ti(r).subscribe(t)}return i.subscribe(t)})},pr=f.empty=function(n){return n||(n=v),new r(function(t){return n.schedule(function(){t.onCompleted()})})},gt=f.fromArray=function(n,t){return t||(t=it),new r(function(i){var r=0;return t.scheduleRecursive(function(t){if(r<n.length){i.onNext(n[r++]);t()}else i.onCompleted()})})};f.generate=function(n,t,i,u,f){return f||(f=it),new r(function(r){var o=!0,e=n;return f.scheduleRecursive(function(n){var f,s;try{o?o=!1:e=i(e),f=t(e),f&&(s=u(e))}catch(h){r.onError(h);return}if(f){r.onNext(s);n()}else r.onCompleted()})})},ni=f.never=function(){return new r(function(){return l})},f.range=function(n,t,i){return i||(i=it),new r(function(r){return i.scheduleRecursiveWithState(0,function(i,u){if(i<t){r.onNext(n+i);u(i+1)}else r.onCompleted()})})},f.repeat=function(n,i,r){return r||(r=it),i==t&&(i=-1),yi(n,r).repeat(i)},yi=f.returnValue=function(n,t){return t||(t=v),new r(function(i){return t.schedule(function(){i.onNext(n);i.onCompleted()})})},ti=f.throwException=function(n,t){return t||(t=v),new r(function(i){return t.schedule(function(){i.onError(n)})})},f.using=function(n,t){return new r(function(i){var u=l,r,f;try{r=n(),r&&(u=r),f=t(r)}catch(e){return new o(ti(e).subscribe(i),u)}return new o(f.subscribe(i),u)})},i.amb=function(n){var t=this;return new r(function(i){function c(){r||(r=u,h.dispose())}function l(){r||(r=f,s.dispose())}var r,u="L",f="R",s=new e,h=new e;return s.setDisposable(t.subscribe(function(n){if(c(),r===u)i.onNext(n)},function(n){if(c(),r===u)i.onError(n)},function(){c(),r===u&&i.onCompleted()})),h.setDisposable(n.subscribe(function(n){if(l(),r===f)i.onNext(n)},function(n){if(l(),r===f)i.onError(n)},function(){l(),r===f&&i.onCompleted()})),new o(s,h)})},f.amb=function(){function u(n,t){return n.amb(t)}for(var t=ni(),i=ut(arguments,0),n=0,r=i.length;n<r;n++)t=u(t,i[n]);return t},i.catchException=function(n){return typeof n=="function"?wr(this,n):pi([this,n])},pi=f.catchException=function(){var n=ut(arguments,0);return bt(n).catchException()},i.combineLatest=function(){var n=s.call(arguments);return Array.isArray(n[0])?n[0].unshift(this):n.unshift(this),wi.apply(this,n)},wi=f.combineLatest=function(){var n=s.call(arguments),t=n.pop();return Array.isArray(n[0])&&(n=n[0]),new r(function(i){function v(n){var r;if(c[n]=!0,l||(l=c.every(function(n){return n}))){try{r=t.apply(null,a)}catch(u){i.onError(u);return}i.onNext(r)}else f.filter(function(t,i){return i!==n}).every(function(n){return n})&&i.onCompleted()}function y(n){f[n]=!0,f.every(function(n){return n})&&i.onCompleted()}for(var h=function(){return!1},r=n.length,c=st(r,h),l=!1,f=st(r,h),a=new Array(r),s=new Array(r),u=0;u<r;u++)(function(t){s[t]=new e,s[t].setDisposable(n[t].subscribe(function(n){a[t]=n,v(t)},i.onError.bind(i),function(){y(t)}))})(u);return new o(s)})},i.concat=function(){var n=s.call(arguments,0);return n.unshift(this),bi.apply(this,n)},bi=f.concat=function(){var n=ut(arguments,0);return bt(n).concat()},i.concatObservable=i.concatAll=function(){return this.merge(1)},i.merge=function(n){if(typeof n!="number")return ki(this,n);var t=this;return new r(function(i){var r=0,u=new o,s=!1,f=[],h=function(n){var t=new e;u.add(t),t.setDisposable(n.subscribe(i.onNext.bind(i),i.onError.bind(i),function(){var n;u.remove(t),f.length>0?(n=f.shift(),h(n)):(r--,s&&r===0&&i.onCompleted())}))};return u.add(t.subscribe(function(t){r<n?(r++,h(t)):f.push(t)},i.onError.bind(i),function(){s=!0,r===0&&i.onCompleted()})),u})},ki=f.merge=function(){var t,n;return arguments[0]?arguments[0].now?(t=arguments[0],n=s.call(arguments,1)):(t=v,n=s.call(arguments,0)):(t=v,n=s.call(arguments,1)),Array.isArray(n[0])&&(n=n[0]),gt(n,t).mergeObservable()},i.mergeObservable=i.mergeAll=function(){var n=this;return new r(function(t){var i=new o,r=!1,u=new e;return i.add(u),u.setDisposable(n.subscribe(function(n){var u=new e;i.add(u),u.setDisposable(n.subscribe(function(n){t.onNext(n)},t.onError.bind(t),function(){i.remove(u),r&&i.length===1&&t.onCompleted()}))},t.onError.bind(t),function(){r=!0,i.length===1&&t.onCompleted()})),i})},i.onErrorResumeNext=function(n){if(!n)throw new Error("Second observable is required");return di([this,n])},di=f.onErrorResumeNext=function(){var n=ut(arguments,0);return new r(function(t){var i=0,r=new c,u=v.scheduleRecursive(function(u){var o,f;i<n.length?(o=n[i++],f=new e,r.setDisposable(f),f.setDisposable(o.subscribe(t.onNext.bind(t),function(){u()},function(){u()}))):t.onCompleted()});return new o(r,u)})},i.skipUntil=function(n){var t=this;return new r(function(i){var u=!1,f=new o(t.subscribe(function(n){if(u)i.onNext(n)},i.onError.bind(i),function(){u&&i.onCompleted()})),r=new e;return f.add(r),r.setDisposable(n.subscribe(function(){u=!0,r.dispose()},i.onError.bind(i),function(){r.dispose()})),f})},i.switchLatest=function(){var n=this;return new r(function(t){var r=!1,u=new c,f=!1,i=0,s=n.subscribe(function(n){var s=new e,o=++i;r=!0,u.setDisposable(s),s.setDisposable(n.subscribe(function(n){if(i===o)t.onNext(n)},function(n){if(i===o)t.onError(n)},function(){i===o&&(r=!1,f&&t.onCompleted())}))},t.onError.bind(t),function(){f=!0,r||t.onCompleted()});return new o(s,u)})},i.takeUntil=function(n){var t=this;return new r(function(i){return new o(t.subscribe(i),n.subscribe(i.onCompleted.bind(i),i.onError.bind(i),w))})},i.zip=function(){if(Array.isArray(arguments[0]))return br.apply(this,arguments);var t=this,n=s.call(arguments),i=n.pop();return n.unshift(t),new r(function(r){function a(n){h[n]=!0,h.every(function(n){return n})&&r.onCompleted()}for(var u=n.length,s=st(u,function(){return[]}),h=st(u,function(){return!1}),l=function(n){var u,f;if(s.every(function(n){return n.length>0})){try{f=s.map(function(n){return n.shift()}),u=i.apply(t,f)}catch(e){r.onError(e);return}r.onNext(u)}else h.filter(function(t,i){return i!==n}).every(function(n){return n})&&r.onCompleted()},c=new Array(u),f=0;f<u;f++)(function(t){c[t]=new e,c[t].setDisposable(n[t].subscribe(function(n){s[t].push(n),l(t)},r.onError.bind(r),function(){a(t)}))})(f);return new o(c)})},f.zip=function(n,t){var i=n[0],r=n.slice(1);return r.push(t),i.zip.apply(i,r)},i.asObservable=function(){var n=this;return new r(function(t){return n.subscribe(t)})},i.bufferWithCount=function(n,i){return i===t&&(i=n),this.windowWithCount(n,i).selectMany(function(n){return n.toArray()}).where(function(n){return n.length>0})},i.dematerialize=function(){var n=this;return new r(function(t){return n.subscribe(function(n){return n.accept(t)},t.onError.bind(t),t.onCompleted.bind(t))})},i.distinctUntilChanged=function(n,t){var i=this;return n||(n=et),t||(t=ir),new r(function(r){var u=!1,f;return i.subscribe(function(i){var o=!1,e;try{e=n(i)}catch(s){r.onError(s);return}if(u)try{o=t(f,e)}catch(s){r.onError(s);return}if(!u||!o){u=!0,f=e;r.onNext(i)}},r.onError.bind(r),r.onCompleted.bind(r))})},i.doAction=function(n,t,i){var f=this,u;return typeof n=="function"?u=n:(u=n.onNext.bind(n),t=n.onError.bind(n),i=n.onCompleted.bind(n)),new r(function(n){return f.subscribe(function(t){try{u(t)}catch(i){n.onError(i)}n.onNext(t)},function(i){if(t){try{t(i)}catch(r){n.onError(r)}n.onError(i)}else n.onError(i)},function(){if(i){try{i()}catch(t){n.onError(t)}n.onCompleted()}else n.onCompleted()})})},i.finallyAction=function(n){var t=this;return new r(function(i){var r=t.subscribe(i);return g(function(){try{r.dispose()}catch(t){throw t;}finally{n()}})})},i.ignoreElements=function(){var n=this;return new r(function(t){return n.subscribe(w,t.onError.bind(t),t.onCompleted.bind(t))})},i.materialize=function(){var n=this;return new r(function(t){return n.subscribe(function(n){t.onNext(ei(n))},function(n){t.onNext(oi(n));t.onCompleted()},function(){t.onNext(si());t.onCompleted()})})},i.repeat=function(n){return li(this,n).concat()},i.retry=function(n){return li(this,n).catchException()},i.scan=function(){var t,i=!1,n,r;return arguments.length===2?(t=arguments[0],n=arguments[1],i=!0):n=arguments[0],r=this,yr(function(){var f=!1,u;return r.select(function(r){return f?u=n(u,r):(u=i?n(t,r):r,f=!0),u})})},i.skipLast=function(n){var t=this;return new r(function(i){var r=[];return t.subscribe(function(t){if(r.push(t),r.length>n)i.onNext(r.shift())},i.onError.bind(i),i.onCompleted.bind(i))})},i.startWith=function(){var i,n,r=0;return arguments.length>0&&arguments[0]!=null&&arguments[0].now!==t?(n=arguments[0],r=1):n=v,i=s.call(arguments,r),bt([gt(i,n),this]).concat()},i.takeLast=function(n,t){return this.takeLastBuffer(n).selectMany(function(n){return gt(n,t)})},i.takeLastBuffer=function(n){var t=this;return new r(function(i){var r=[];return t.subscribe(function(t){r.push(t),r.length>n&&r.shift()},i.onError.bind(i),function(){i.onNext(r);i.onCompleted()})})},i.windowWithCount=function(n,t){var i=this;if(n<=0)throw new Error(k);if(t==null&&(t=n),t<=0)throw new Error(k);return new r(function(r){var o=new e,s=new wt(o),f=0,u=[],h=function(){var n=new tr;u.push(n);r.onNext(er(n,s))};return h(),o.setDisposable(i.subscribe(function(i){for(var o,e,r=0,s=u.length;r<s;r++)u[r].onNext(i);e=f-n+1,e>=0&&e%t==0&&(o=u.shift(),o.onCompleted()),f++,f%t==0&&h()},function(n){while(u.length>0)u.shift().onError(n);r.onError(n)},function(){while(u.length>0)u.shift().onCompleted();r.onCompleted()})),s})},i.defaultIfEmpty=function(n){var i=this;return n===t&&(n=null),new r(function(t){var r=!1;return i.subscribe(function(n){r=!0;t.onNext(n)},t.onError.bind(t),function(){if(!r)t.onNext(n);t.onCompleted()})})},i.distinct=function(n,t){var i=this;return n||(n=et),t||(t=ui),new r(function(r){var u={};return i.subscribe(function(i){var e,f,o,s=!1;try{e=n(i),f=t(e)}catch(h){r.onError(h);return}for(o in u)if(f===o){s=!0;break}if(!s){u[f]=null;r.onNext(i)}},r.onError.bind(r),r.onCompleted.bind(r))})},i.groupBy=function(n,t,i){return this.groupByUntil(n,t,function(){return ni()},i)},i.groupByUntil=function(n,t,i,u){var f=this;return t||(t=et),u||(u=ui),new r(function(r){var s={},h=new o,c=new wt(h);return h.add(f.subscribe(function(f){var k,d,g,nt,b,tt,y,v,p,l,o;try{y=n(f),v=u(y)}catch(a){for(o in s)s[o].onError(a);r.onError(a);return}b=!1;try{l=s[v],l||(l=new tr,s[v]=l,b=!0)}catch(a){for(o in s)s[o].onError(a);r.onError(a);return}if(b){tt=new nr(y,l,c),d=new nr(y,l);try{k=i(d)}catch(a){for(o in s)s[o].onError(a);r.onError(a);return}r.onNext(tt);p=new e,h.add(p),nt=function(){v in s&&(delete s[v],l.onCompleted()),h.remove(p)},p.setDisposable(k.take(1).subscribe(w,function(n){for(o in s)s[o].onError(n);r.onError(n)},function(){nt()}))}try{g=t(f)}catch(a){for(o in s)s[o].onError(a);r.onError(a);return}l.onNext(g)},function(n){for(var t in s)s[t].onError(n);r.onError(n)},function(){for(var n in s)s[n].onCompleted();r.onCompleted()})),c})},i.select=i.map=function(n){var t=this;return new r(function(i){var r=0;return t.subscribe(function(t){var u;try{u=n(t,r++)}catch(f){i.onError(f);return}i.onNext(u)},i.onError.bind(i),i.onCompleted.bind(i))})},i.selectMany=i.flatMap=function(n,t){return t?this.selectMany(function(i){return n(i).select(function(n){return t(i,n)})}):typeof n=="function"?gi.call(this,n):gi.call(this,function(){return n})},i.skip=function(n){if(n<0)throw new Error(k);var t=this;return new r(function(i){var r=n;return t.subscribe(function(n){if(r<=0)i.onNext(n);else r--},i.onError.bind(i),i.onCompleted.bind(i))})},i.skipWhile=function(n){var t=this;return new r(function(i){var u=0,r=!1;return t.subscribe(function(t){if(!r)try{r=!n(t,u++)}catch(f){i.onError(f);return}if(r)i.onNext(t)},i.onError.bind(i),i.onCompleted.bind(i))})},i.take=function(n,t){if(n<0)throw new Error(k);if(n===0)return pr(t);var i=this;return new r(function(t){var r=n;return i.subscribe(function(n){if(r>0){r--;t.onNext(n);r===0&&t.onCompleted()}},t.onError.bind(t),t.onCompleted.bind(t))})},i.takeWhile=function(n){var t=this;return new r(function(i){var u=0,r=!0;return t.subscribe(function(t){if(r){try{r=n(t,u++)}catch(f){i.onError(f);return}if(r)i.onNext(t);else i.onCompleted()}},i.onError.bind(i),i.onCompleted.bind(i))})},i.where=i.filter=function(n){var t=this;return new r(function(i){var r=0;return t.subscribe(function(t){var u;try{u=n(t,r++)}catch(f){i.onError(f);return}if(u)i.onNext(t)},i.onError.bind(i),i.onCompleted.bind(i))})};var r=u.Internals.AnonymousObservable=function(n){function t(t){function i(n){var i=new kr(n);if(it.scheduleRequired())it.schedule(function(){try{i.disposable(t(i))}catch(n){if(!i.fail(n))throw n;}});else try{i.disposable(t(i))}catch(r){if(!i.fail(r))throw r;}return i}n.call(this,i)}return h(t,n),t}(f),kr=function(n){function i(t){n.call(this),this.observer=t,this.m=new e}h(i,n);var t=i.prototype;return t.next=function(n){var t=!1;try{this.observer.onNext(n);t=!0}catch(i){throw i;}finally{t||this.dispose()}},t.error=function(n){try{this.observer.onError(n)}catch(t){throw t;}finally{this.dispose()}},t.completed=function(){try{this.observer.onCompleted()}catch(n){throw n;}finally{this.dispose()}},t.disposable=function(n){return this.m.disposable(n)},t.dispose=function(){n.prototype.dispose.call(this),this.m.dispose()},i}(kt),nr=function(n){function i(n){return this.underlyingObservable.subscribe(n)}function t(t,u,f){n.call(this,i),this.key=t,this.underlyingObservable=f?new r(function(n){return new o(f.getDisposable(),u.subscribe(n))}):u}return h(t,n),t}(f),ii=function(n,t){this.subject=n,this.observer=t};ii.prototype.dispose=function(){if(!this.subject.isDisposed&&this.observer!==null){var n=this.subject.observers.indexOf(this.observer);this.subject.observers.splice(n,1),this.observer=null}};var tr=u.Subject=function(n){function i(n){if(b.call(this),!this.isStopped)return this.observers.push(n),new ii(this,n);if(this.exception){n.onError(this.exception);return l}return n.onCompleted(),l}function t(){n.call(this,i),this.isDisposed=!1,this.isStopped=!1,this.observers=[]}return h(t,n),at(t.prototype,y,{hasObservers:function(){return this.observers.length>0},onCompleted:function(){var t,n,i;if(b.call(this),!this.isStopped){for(t=this.observers.slice(0),this.isStopped=!0,n=0,i=t.length;n<i;n++)t[n].onCompleted();this.observers=[]}},onError:function(n){var i,t,r;if(b.call(this),!this.isStopped){for(i=this.observers.slice(0),this.isStopped=!0,this.exception=n,t=0,r=i.length;t<r;t++)i[t].onError(n);this.observers=[]}},onNext:function(n){var i,t,r;if(b.call(this),!this.isStopped)for(i=this.observers.slice(0),t=0,r=i.length;t<r;t++)i[t].onNext(n)},dispose:function(){this.isDisposed=!0,this.observers=null}}),t.create=function(n,t){return new gr(n,t)},t}(f),dr=u.AsyncSubject=function(n){function i(n){if(b.call(this),!this.isStopped)return this.observers.push(n),new ii(this,n);var t=this.exception,i=this.hasValue,r=this.value;if(t)n.onError(t);else if(i){n.onNext(r);n.onCompleted()}else n.onCompleted();return l}function t(){n.call(this,i),this.isDisposed=!1,this.isStopped=!1,this.value=null,this.hasValue=!1,this.observers=[],this.exception=null}return h(t,n),at(t.prototype,y,{hasObservers:function(){return this.observers.length>0},onCompleted:function(){var r,n,i,t,u,f;if(b.call(this),!this.isStopped){if(t=this.observers.slice(0),this.isStopped=!0,u=this.value,f=this.hasValue,f)for(n=0,i=t.length;n<i;n++){r=t[n];r.onNext(u);r.onCompleted()}else for(n=0,i=t.length;n<i;n++)t[n].onCompleted();this.observers=[]}},onError:function(n){var i,t,r;if(b.call(this),!this.isStopped){for(i=this.observers.slice(0),this.isStopped=!0,this.exception=n,t=0,r=i.length;t<r;t++)i[t].onError(n);this.observers=[]}},onNext:function(n){b.call(this),this.isStopped||(this.value=n,this.hasValue=!0)},dispose:function(){this.isDisposed=!0,this.observers=null,this.exception=null,this.value=null}}),t}(f),gr=function(n){function i(n){return this.observable.subscribe(n)}function t(t,r){n.call(this,i),this.observer=t,this.observable=r}return h(t,n),at(t.prototype,y,{onCompleted:function(){this.observer.onCompleted()},onError:function(n){this.observer.onError(n)},onNext:function(n){this.observer.onNext(n)}}),t}(f);if(typeof define=="function"&&typeof define.amd=="object"&&define.amd)return n.Rx=u,define(function(){return u});lt?typeof module=="object"&&module&&module.exports==lt?module.exports=u:lt=u:n.Rx=u})(this);
//@ sourceMappingURL=rx.min.js.map